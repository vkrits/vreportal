/*
 * To change this license header, choose License Headers in Project Properties.
 * To change this template file, choose Tools | Templates
 * and open the template in the editor.
 */
package forth.ics.isl.data.model.suggest;

import forth.ics.isl.data.model.parser.QueryDataModel;
import forth.ics.isl.data.model.parser.RelatedModel;
import forth.ics.isl.data.model.parser.TargetModel;
import forth.ics.isl.data.model.parser.Utils;
import forth.ics.isl.service.DBService;
import forth.ics.isl.triplestore.RestClient;
import java.io.IOException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;
import org.json.simple.JSONArray;
import org.json.simple.JSONObject;
import org.json.simple.parser.JSONParser;
import org.json.simple.parser.ParseException;

/**
 *
 * @author rousakis
 */
public class EntitiesSuggester {

    private QueryDataModel model;
    private String fromClause;
    private RelatedModel rowModel;
    private String namespace, endpoint, token;

    public EntitiesSuggester(JSONObject jsonModel, String namespace, String endpoint, String token) {
        init(jsonModel);
        this.namespace = namespace;
        this.endpoint = endpoint;
        this.token = token;
    }

    public EntitiesSuggester(String rowModel, String queryModel, String namespace, String endpoint, String token) {
        this.model = new QueryDataModel(queryModel);
        this.rowModel = new RelatedModel(rowModel);
        this.fromClause = model.getSelectedGraphsClause();
        this.namespace = namespace;
        this.endpoint = endpoint;
        this.token = token;
    }

    public EntitiesSuggester(String jsonModelString) {
        JSONObject jsonModel = Utils.parse(jsonModelString);
        init(jsonModel);
    }

    private void init(JSONObject jsonModel) {
        this.model = new QueryDataModel(jsonModel);
        this.fromClause = (String) jsonModel.get("queryFrom");
    }

    public String getFromClause() {
        return fromClause;
    }

    public RelatedModel getRowModel() {
        return rowModel;
    }

    public QueryDataModel getModel() {
        return model;
    }

    public JSONArray retrieveRelationsEntities(ArrayList<Map> entities) throws IOException, ParseException, SQLException {
        Connection conn = DriverManager.getConnection("jdbc:h2:~/evre", "sa", "");
        DBService.setConnection(conn);
        DBService.setJdbcTemplateUsed(false);
        Map<String, String> relations = DBService.retrieveAllRelations();
        HashMap<String, JSONObject> entitiesMap = new HashMap<>();
        for (int i = 0; i < entities.size(); i++) {
            JSONObject entity = new JSONObject(entities.get(i));
            entitiesMap.put((String) entity.get("uri"), entity);
        }
        JSONArray result = new JSONArray();
        ////
        TargetModel tModel = getModel().getTargetModel();
        List<RelatedModel> relModels = getModel().getRelatedModels();
        JSONArray queries = new JSONArray();
        //find the related model selected
        RelatedModel row = getRowModel();
        RelatedModel found = findRelatedModel(relModels, row, null);
        if (found != null) {
            // examine the potential relations and construct the corresponding queries
            for (String relation : found.getSugRelationsRelatedEntities().keySet()) {
                int pos = 0;
                StringBuilder query = new StringBuilder();
                query.append("select * " + getFromClause() + " where {\n");
                RelatedModel probeModel = found;
                String relEnt = probeModel.getRelatedVarName() + "_" + pos;
                StringBuilder related = new StringBuilder();
                String relEntity = probeModel.getSugRelationsRelatedEntities().get(relation);
                related.append("?" + relEnt + " <" + relation + "> [a <" + relEntity + ">].\n");
                //complete the query with the parent nodes 
                RelatedModel parent = probeModel.getParentModel();
                while (parent != null) {
                    query.append("?" + parent.getRelatedVarName() + "_" + pos + " <" + probeModel.getRelationUri() + "> ?" + relEnt + ".\n").
                            append((probeModel.getKeywordSearchPattern(relEnt) + "\n").trim());
                    probeModel = parent;
                    relEnt = probeModel.getRelatedVarName() + "_" + pos;
                    parent = parent.getParentModel();
                    pos++;
                }
                StringBuilder targetRel = new StringBuilder();
                targetRel.append("?" + tModel.getVarName() + " <" + probeModel.getRelationUri() + "> ?" + relEnt + ".\n").
                        append((probeModel.getKeywordSearchPattern(relEnt) + "\n").trim());
//                System.out.println(query.toString() + targetRel + related + "} limit 1");
                queries.add(query.toString() + targetRel + related + "} limit 1");
            }
            // execute the set of queries
            RestClient client = new RestClient(endpoint, namespace, token);
            JSONArray results = (JSONArray) new JSONParser().parse(client.executeBatchSparqlQueryPOST(queries, "application/json").readEntity(String.class));
            int i = 0;
            for (String relation : found.getSugRelationsRelatedEntities().keySet()) {
                JSONObject qRes = (JSONObject) new JSONParser().parse((String) results.get(i));
                JSONArray res = (JSONArray) ((JSONObject) qRes.get("results")).get("bindings");
                if (!res.isEmpty()) {
                    String relatedEntityUri = found.getSugRelationsRelatedEntities().get(relation);
                    JSONObject obj = new JSONObject();
                    JSONObject relatedEntity = entitiesMap.get(relatedEntityUri);
                    obj.put("related_entity", relatedEntity);
                    JSONObject relJSON = new JSONObject();
                    relJSON.put("uri", relation);
                    relJSON.put("name", relations.get(relation));
                    obj.put("relation", relJSON);
                    result.add(obj);
                    System.out.println(relation + " -> " + found.getSugRelationsRelatedEntities().get(relation));

                }
                i++;
            }
        }
        return result;
    }

    public RelatedModel findRelatedModel(List<RelatedModel> relModels, RelatedModel searched, RelatedModel found) {
        for (RelatedModel relModel : relModels) {
            if (found != null) {
                break;
            }
            if (relModel.equals(searched)) {
                return findRelatedModel(relModel.getRelatedModels(), searched, relModel);
            }
            if (!relModel.getRelatedModels().isEmpty()) {
                return findRelatedModel(relModel.getRelatedModels(), searched, found);
            }
        }
        return found;
    }

    public static void main(String[] args) throws IOException, ParseException, SQLException {
        //QueryModel: Person -> OrgUnit
        String queryModel = "{\"queryFrom\":\"from <http://ekt-data> from <http://rcuk-data> from <http://fris-data> from <http://epos-data> from <http://envri-data> \",\"queryModel\":{\"targetModel\":{\"selectedTargetEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct ?persName ?Service (?pers as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchTargetKeywords\":\"\",\"selectedTargetRecomentation\":null,\"targetChips\":[]},\"relatedModels\":[{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"maria\",\"rowModelList\":[{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}]}}";
        //QueryModel: Person -> OrgUnit -> Project
//        queryModel = "{\"queryFrom\":\"from <http://ekt-data> from <http://rcuk-data> from <http://fris-data> from <http://epos-data> from <http://envri-data> \",\"queryModel\":{\"targetModel\":{\"selectedTargetEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct ?persName ?Service (?pers as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchTargetKeywords\":\"\",\"selectedTargetRecomentation\":null,\"targetChips\":[]},\"relatedModels\":[{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"maria\",\"rowModelList\":[{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"contributed in\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit-Project/contributed%20in\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/project-acronyms.json\",\"name\":\"Project\",\"id\":7,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri) @#$%FROM%$#@ \\nwhere {\\n?proj <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?proj a cerif:Project.\\n?proj cerif:has_title ?projectTitle.\\nOPTIONAL {?proj cerif:has_URI ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?projectURI).\\n?proj cerif:has_acronym ?projectAcronym.\\n?proj rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\\n?projName bds:relevance ?score \\n} ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Project\",\"var_name\":\"proj\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[{\"id\":2,\"level\":2,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}]}}";
        //Person -> OrgUnit -> Project -> Person
//        queryModel = "{\"queryFrom\":\"from <http://ekt-data> from <http://rcuk-data> from <http://fris-data> from <http://epos-data> from <http://envri-data> \",\"queryModel\":{\"targetModel\":{\"selectedTargetEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct ?persName ?Service (?pers as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchTargetKeywords\":\"\",\"selectedTargetRecomentation\":null,\"targetChips\":[]},\"relatedModels\":[{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"contributed in\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit-Project/contributed%20in\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/project-acronyms.json\",\"name\":\"Project\",\"id\":7,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri) @#$%FROM%$#@ \\nwhere {\\n?proj <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?proj a cerif:Project.\\n?proj cerif:has_title ?projectTitle.\\nOPTIONAL {?proj cerif:has_URI ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?projectURI).\\n?proj cerif:has_acronym ?projectAcronym.\\n?proj rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\\n?projName bds:relevance ?score \\n} ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Project\",\"var_name\":\"proj\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[{\"id\":2,\"level\":2,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"has contact\",\"uri\":\"http://eurocris.org/ontology/cerif#Project-Person/has%20contact\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":7,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct ?persName ?Service (?pers as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[{\"id\":3,\"level\":3,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}]}}";
        //rowModel: OrgUnit
        String rowModel = "{\"id\":0,\"level\":0,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"is member of\",\"uri\":\"http://eurocris.org/ontology/cerif#Person-OrganisationUnit/is%20member%20of\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":2,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"maria\",\"rowModelList\":[{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}";
        //rowModel: Project
//        rowModel = "{\"id\":1,\"level\":1,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"contributed in\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit-Project/contributed%20in\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/project-acronyms.json\",\"name\":\"Project\",\"id\":7,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri) @#$%FROM%$#@ \\nwhere {\\n?proj <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?proj a cerif:Project.\\n?proj cerif:has_title ?projectTitle.\\nOPTIONAL {?proj cerif:has_URI ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?projectURI).\\n?proj cerif:has_acronym ?projectAcronym.\\n?proj rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\\n?projName bds:relevance ?score \\n} ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Project\",\"var_name\":\"proj\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[{\"id\":2,\"level\":2,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}";
        //rowModel: Person
//        rowModel = "{\"id\":2,\"level\":2,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":{\"name\":\"has contact\",\"uri\":\"http://eurocris.org/ontology/cerif#Project-Person/has%20contact\"},\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":7,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct ?persName ?Service (?pers as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[{\"id\":3,\"level\":3,\"outerSelectedFilterExpression\":\"\",\"selectedRelation\":null,\"rangeOfDates\":{\"from\":null,\"fromInputName\":\"\",\"until\":null,\"untilInputName\":\"\"},\"selectedRelatedEntity\":null,\"searchRelatedKeywords\":\"\",\"allRelatedSearchResultsIsSelected\":false,\"allRelatedEntitiesSelectedList\":[{\"name\":\"All Instances Selected\"}],\"selectedRelatedInstanceList\":[],\"shownEntitySearchResults\":false,\"selectedRecomentation\":null,\"relatedChips\":[],\"relatedEntitySearchText\":\"\",\"rowModelList\":[],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}],\"activeRelatedSearchResultsStyle\":\"enabled-style\",\"activeRowModelStyle\":\"enabled-style\"}";

        String token = "4c007c2e-0443-4368-9486-d08ba4fc1c10";
        String endpoint = "http://139.91.183.48:8181/EVREMetadataServices";
        endpoint = "http://139.91.183.97:8080/EVREMetadataServices-1.0-SNAPSHOT";
        String namespace = "vre4eic";

        /////////////////////////////////
        EntitiesSuggester suggester = new EntitiesSuggester(rowModel, queryModel, namespace, endpoint, token);
        ArrayList<Map> entities = new ArrayList();
        JSONArray entitiesJSON = (JSONArray) new JSONParser().parse("[{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/persons-firstAndLastNames.json\",\"name\":\"Person\",\"id\":1,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct ?persName ?Service (?pers as ?uri) @#$%FROM%$#@\\nwhere {\\n?pers <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.  \\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.  \\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.  \\n?Ser cerif:has_acronym ?Service.\\n?pers a cerif:Person.  \\n?pers rdfs:label ?persName. \\n?persName bds:search \\\"@#$%TERM%$#@\\\".  \\n?persName bds:relevance ?score. \\n}  ORDER BY desc(?score) ?pers\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct ?persName ?Service (?pers as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Person\",\"var_name\":\"pers\"},{\"keyword_search\":\"?@#$%VAR%$#@ rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/project-acronyms.json\",\"name\":\"Project\",\"id\":2,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri) @#$%FROM%$#@ \\nwhere {\\n?proj <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?proj a cerif:Project.\\n?proj cerif:has_title ?projectTitle.\\nOPTIONAL {?proj cerif:has_URI ?projURI.}\\nBIND(if(bound(?projURI),?projURI,?proj) as ?projectURI).\\n?proj cerif:has_acronym ?projectAcronym.\\n?proj rdfs:label ?projName.\\n?projName bds:search \\\"@#$%TERM%$#@\\\".\\n?projName bds:relevance ?score \\n} ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?projectTitle as ?title) ?projectAcronym ?Service (?proj as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Project\",\"var_name\":\"proj\"},{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_title> ?pubTitle.\\n?pubTitle bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":\"FALSE\",\"thesaurus\":\"thesaurus/publications-titles.json\",\"name\":\"Publication\",\"id\":3,\"queryModel\":{\"geo_query\":\"\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?pubTitle as ?title) (?pubDate as ?publication_date) ?Service (?pub as ?uri) @#$%FROM%$#@ \\nwhere {\\n?pub <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?pub a cerif:Publication.\\n?pub cerif:has_title ?pubTitle.\\n?pub cerif:has_publicationDate ?pubDate.\\n?pubTitle bds:search \\\"@#$%TERM%$#@\\\".\\n?pubTitle bds:relevance ?score.\\n}ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"\"},\"selection_list\":\"distinct (?pubTitle as ?title) (?pubDate as ?publication_date) ?Service (?pub as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Publication\",\"var_name\":\"pub\"},{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?orgName.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"thesaurus/organizationUnits-acronyms.json\",\"name\":\"OrganisationUnit\",\"id\":4,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#> \\nselect distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri) ?east ?west ?north ?south @#$%FROM%$#@ \\nwhere {\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?org a cerif:OrganisationUnit.\\n?org cerif:has_name ?orgName.\\n?org cerif:has_acronym ?orgAcronym.\\n?org <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?orgName bds:search \\\"@#$%TERM%$#@\\\".\\n?orgName bds:relevance ?score.\\n}ORDER BY desc(?score)\"},\"selection_list\":\"distinct (?orgName as ?name) (?orgAcronym as ?acronym) ?Service (?org as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#OrganisationUnit\",\"var_name\":\"org\"},{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?name.\\n?name bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"\",\"name\":\"Product\",\"id\":5,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) ?east ?west ?north ?south \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Product.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Product.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?name bds:search \\\"@#$%TERM%$#@\\\".\\n?name bds:relevance ?score.\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n} ORDER BY desc(?score) \",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) ?east ?west ?north ?south \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Product.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?name bds:search \\\"@#$%TERM%$#@\\\".\\n?name bds:relevance ?score.\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n} ORDER BY desc(?score)\"},\"selection_list\":\"distinct ?name  ?Responsible ?Service (?object as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Product\",\"var_name\":\"object\"},{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?name.\\n?name bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"\",\"name\":\"Equipment\",\"id\":6,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) ?east ?west ?north ?south \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Equipment.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Equipment.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?name bds:search \\\"@#$%TERM%$#@\\\".\\n?name bds:relevance ?score.\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n} ORDER BY desc(?score) \",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) ?east ?west ?north ?south \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Equipment.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?name bds:search \\\"@#$%TERM%$#@\\\".\\n?name bds:relevance ?score.\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n} ORDER BY desc(?score)\"},\"selection_list\":\"distinct ?name  ?Responsible ?Service (?object as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Equipment\",\"var_name\":\"object\"},{\"keyword_search\":\"?@#$%VAR%$#@ <http://eurocris.org/ontology/cerif#has_name> ?name.\\n?name bds:search \\\"@#$%TERM%$#@\\\".\",\"geospatial\":true,\"thesaurus\":\"\",\"name\":\"Facility\",\"id\":7,\"queryModel\":{\"geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) ?east ?west ?north ?south \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Facility.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n}\",\"query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Facility.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?name bds:search \\\"@#$%TERM%$#@\\\".\\n?name bds:relevance ?score.\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n} ORDER BY desc(?score) \",\"format\":\"application/json\",\"text_geo_query\":\"PREFIX cerif:<http://eurocris.org/ontology/cerif#>\\nSELECT DISTINCT ?name  ?Responsible ?Service (?object as ?uri) ?east ?west ?north ?south \\n@#$%FROM%$#@\\nWHERE {\\n?object a cerif:Facility.\\n?object cerif:has_name ?name.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLES.\\n?FLES <http://eurocris.org/ontology/cerif#has_destination> ?Ser.\\n?FLES cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.provenance>.\\n?Ser cerif:has_acronym ?Service.\\n?object <http://eurocris.org/ontology/cerif#is_source_of> ?FLE1.\\n?FLE1 <http://eurocris.org/ontology/cerif#has_destination> ?PA.\\n?PA <http://eurocris.org/ontology/cerif#is_source_of> ?FLE2.\\n?FLE2 <http://eurocris.org/ontology/cerif#has_destination> ?GBB.\\n?GBB <http://eurocris.org/ontology/cerif#has_eastBoundaryLongitude> ?east.\\n?GBB <http://eurocris.org/ontology/cerif#has_westBoundaryLongitude> ?west.\\n?GBB <http://eurocris.org/ontology/cerif#has_northBoundaryLatitude> ?north.\\n?GBB <http://eurocris.org/ontology/cerif#has_southBoundaryLatitude> ?south.\\nFILTER(xsd:float(?east) <= @#$%EAST%$#@ && xsd:float(?west) >= @#$%WEST%$#@ && xsd:float(?north) <= @#$%NORTH%$#@ && xsd:float(?south) >= @#$%SOUTH%$#@)\\n?name bds:search \\\"@#$%TERM%$#@\\\".\\n?name bds:relevance ?score.\\nOptional {\\n?object cerif:is_destination_of ?FLE3.\\n?FLE3 cerif:has_classification <http://139.91.183.70:8090/vre4eic/Classification.Responsible>.\\noptional {\\n?FLE3 cerif:has_source ?OUorP. ?OUorP cerif:has_name ?nameOUorP.\\noptional{\\n?OUorP <http://eurocris.org/ontology/cerif#is_source_of> ?FLE4.?FLE4 <http://eurocris.org/ontology/cerif#has_destination> ?OU. ?OU cerif:has_name ?nameOU.\\n}\\n}\\n}\\nbind(coalesce(?nameOU, ?nameOUorP) as ?Responsible).\\n} ORDER BY desc(?score)\"},\"selection_list\":\"distinct ?name  ?Responsible ?Service (?object as ?uri)\",\"uri\":\"http://eurocris.org/ontology/cerif#Facility\",\"var_name\":\"object\"}]");
        for (int i = 0; i < entitiesJSON.size(); i++) {
            JSONObject obj = (JSONObject) entitiesJSON.get(i);
            Map map = (Map) obj;
            entities.add(map);
        }
        JSONArray result = suggester.retrieveRelationsEntities(entities);
        System.out.println(result);
    }

}